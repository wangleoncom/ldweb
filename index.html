<!DOCTYPE html>
<html lang="zh-TW" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¹¿ğŸ¦Œçš„ QA æª”æ¡ˆå®¤</title>
    <link rel="icon" href="icon.jpg" type="image/jpeg">
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Rounded+Mplus+1c:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="./deer_db.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        deer: {
                            50: '#fdf2f8', 100: '#fce7f3', 200: '#fbcfe8', 300: '#f9a8d4', 
                            400: '#f472b6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d', 900: '#831843',
                        }
                    },
                    fontFamily: {
                        sans: ['"Rounded Mplus 1c"', '"Noto Sans TC"', 'sans-serif'],
                    },
                    animation: {
                        'wiggle': 'wiggle 0.2s ease-in-out infinite',
                    },
                    keyframes: {
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .glass { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.4); }
        .dark .glass { background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); }
        .msg-pop { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.9) translateY(10px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .medal-glow { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6)); }
    </style>
</head>
<body class="bg-deer-50 text-gray-700 transition-colors duration-300 dark:bg-gray-900 dark:text-gray-100 font-sans min-h-screen selection:bg-deer-300 selection:text-deer-900"
      x-data="deerApp()" x-init="initApp()">

    <div class="fixed inset-0 overflow-hidden -z-10 pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-96 h-96 bg-deer-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-purple-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse delay-1000"></div>
    </div>

    <nav class="fixed top-0 w-full z-50 glass shadow-sm transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 h-16 flex justify-between items-center">
            <div class="flex items-center cursor-pointer" @click="changeTab('home')">
                <img src="./icon.jpg" class="w-8 h-8 rounded-full mr-2 border border-deer-300 object-cover" @click.stop="triggerEasterEgg('icon')">
                <span class="font-bold text-xl text-deer-600 dark:text-deer-300 hidden sm:block">é¹¿çš„ QA æª”æ¡ˆå®¤</span>
            </div>
            <div class="flex space-x-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-full">
                <button @click="changeTab('home')" :class="tabClass('home')">é¦–é </button>
                <button @click="changeTab('ai')" :class="tabClass('ai')">AI éº‹é¹¿</button>
                <button @click="startQuizMode()" :class="tabClass('quiz')">æ¸¬é©— 2.0</button>
            </div>
            <button @click="toggleDarkMode" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                <span x-text="isDark ? 'â˜€ï¸' : 'ğŸŒ™'"></span>
            </button>
        </div>
    </nav>

    <main class="pt-24 pb-12 px-4 max-w-7xl mx-auto min-h-[80vh]">
        
        <div x-show="currentTab === 'home'" x-transition.opacity>
            
            <div class="glass rounded-2xl p-6 mb-8 border-l-4 border-deer-400 flex flex-col md:flex-row items-center gap-6 shadow-lg transform transition hover:scale-[1.01]">
                <img src="icon.jpg" alt="é¹¿" 
                     class="w-24 h-24 md:w-32 md:h-32 rounded-full object-cover shadow-md border-4 border-white dark:border-gray-700 cursor-pointer hover:rotate-12 transition-transform"
                     @click="triggerEasterEgg('profile')">
                
                <div class="flex-1 text-center md:text-left">
                    <h2 class="text-2xl font-bold">é¹¿ (Walking Deer)</h2>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2 leading-relaxed">
                        ğŸ‚ 10/03 å¤©ç§¤åº§ | ğŸ“ 170cm | âš–ï¸ 42kg<br>
                        ğŸˆ è²“å’ªï¼šå“ºåš• (è‹±çŸ­)
                    </p>
                    <div class="flex justify-center md:justify-start gap-3 mt-4">
                        <a href="https://www.tiktok.com/@ld.1003_" target="_blank" class="px-4 py-1.5 bg-black text-white rounded-full text-sm font-medium hover:opacity-80 transition">TikTok</a>
                        <a href="https://www.instagram.com/ld.1003_/" target="_blank" class="px-4 py-1.5 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full text-sm font-medium hover:opacity-80 transition">Instagram</a>
                    </div>
                </div>
            </div>

            <div class="sticky top-20 z-40 mb-8">
                <div class="relative max-w-2xl mx-auto">
                    <input type="text" x-model="search" @input="currentPage = 1" placeholder="è¼¸å…¥é—œéµå­—... (ä¾‹å¦‚: é¹¿ ç”·å‹)" 
                           class="w-full pl-12 pr-4 py-4 rounded-full glass border-none focus:ring-2 focus:ring-deer-400 shadow-lg text-lg">
                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-2xl">ğŸ”</span>
                </div>
                <div class="text-center mt-2 text-sm text-gray-500">
                    <span x-show="search.length > 0">
                        ç©åˆ†æœå°‹ä¸­... æ‰¾åˆ° <span x-text="filteredQuestions.length"></span> ç­†
                    </span>
                    <span x-show="search.length === 0">
                        é¡¯ç¤º <span x-text="currentPage"></span> / <span x-text="totalPages"></span> é 
                    </span>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 min-h-[400px]">
                <template x-for="item in paginatedData" :key="item.id">
                    <div class="group h-64 perspective-1000 cursor-pointer" @click="toggleCard(item.id)">
                        <div class="relative w-full h-full transform-style-3d transition-transform duration-700 shadow-xl rounded-2xl"
                             :class="{ 'rotate-y-180': flippedCards.includes(item.id) }">
                            
                            <div class="absolute w-full h-full glass rounded-2xl p-6 flex flex-col justify-between backface-hidden border-t-4 border-deer-300">
                                <div>
                                    <span class="text-xs font-bold text-deer-500 bg-deer-100 dark:bg-deer-900 px-2 py-1 rounded">Q.<span x-text="item.id"></span></span>
                                    <h3 class="text-lg font-bold mt-2" x-text="item.q"></h3>
                                    <span x-show="search.length > 0 && item.score > 0" class="text-xs text-pink-500 font-mono mt-1 block">
                                        Match Score: <span x-text="item.score"></span>
                                    </span>
                                </div>
                                <div class="text-right text-sm text-gray-400">é»æ“Šçœ‹ç­”æ¡ˆ ğŸ‘‰</div>
                            </div>

                            <div class="absolute w-full h-full glass rounded-2xl p-6 flex flex-col backface-hidden rotate-y-180 bg-white dark:bg-gray-800 border-b-4 border-purple-400 overflow-y-auto">
                                <p class="text-lg font-medium flex-1" x-text="item.a"></p>
                                <button @click.stop="shareItem(item)" class="self-end mt-2 flex items-center gap-1 text-xs text-deer-500 hover:text-deer-700 bg-deer-50 px-3 py-1 rounded-full">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg>
                                    è¤‡è£½åˆ†äº«
                                </button>
                            </div>
                        </div>
                    </div>
                </template>
            </div>

            <div class="flex flex-wrap justify-center items-center mt-10 gap-3 pb-8" x-show="totalPages > 1">
                <button @click="goToPage(1)" :disabled="currentPage === 1" 
                        class="px-4 py-2 rounded-full glass hover:bg-deer-100 disabled:opacity-30 disabled:cursor-not-allowed transition text-sm">
                    |â—€ é¦–é 
                </button>
                <button @click="prevPage" :disabled="currentPage === 1" 
                        class="px-4 py-2 rounded-full glass hover:bg-deer-100 disabled:opacity-30 disabled:cursor-not-allowed transition">
                    â—€ ä¸Šä¸€é 
                </button>
                <span class="font-bold text-deer-600 dark:text-deer-300 px-2">
                    <span x-text="currentPage"></span> / <span x-text="totalPages"></span>
                </span>
                <button @click="nextPage" :disabled="currentPage === totalPages" 
                        class="px-4 py-2 rounded-full glass hover:bg-deer-100 disabled:opacity-30 disabled:cursor-not-allowed transition">
                    ä¸‹ä¸€é  â–¶
                </button>
                <button @click="goToPage(totalPages)" :disabled="currentPage === totalPages" 
                        class="px-4 py-2 rounded-full glass hover:bg-deer-100 disabled:opacity-30 disabled:cursor-not-allowed transition text-sm">
                    æœ«é  â–¶|
                </button>
            </div>
        </div>

        <div x-show="currentTab === 'ai'" x-cloak class="max-w-2xl mx-auto h-[75vh] flex flex-col glass rounded-2xl overflow-hidden shadow-2xl relative">
            
            <div x-show="aiStatus !== 'online'" class="absolute inset-0 z-20 bg-white/95 dark:bg-gray-900/95 flex flex-col items-center justify-center text-center p-6 transition-opacity duration-500">
                <div class="relative group cursor-pointer" @click="wakeUpAI">
                    <img src="./AI.png" alt="Sleeping AI" 
                         class="w-32 h-32 rounded-full object-cover mb-4 border-4 border-gray-300 grayscale opacity-80 transition-all active:scale-95 hover:grayscale-0 hover:opacity-100"
                         :class="{'animate-wiggle': wakeUpCount > 0}">
                    <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 bg-deer-500 text-white text-xs px-2 py-1 rounded-full whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity">
                        é»æ“Šå«é†’æˆ‘ï¼
                    </div>
                </div>
                
                <h3 class="text-2xl font-bold mb-2 text-gray-800 dark:text-white">AI å°éº‹é¹¿ç›®å‰...</h3>
                <p class="text-deer-600 text-lg font-medium mb-4" x-text="aiStatusText"></p>
                
                <p class="text-sm text-gray-400" x-show="wakeUpCount > 0">
                    å†é» <span class="text-red-500 font-bold text-lg" x-text="5 - wakeUpCount"></span> ä¸‹å«ä»–ï¼
                </p>
            </div>

            <div class="bg-deer-100 dark:bg-deer-900 p-4 flex items-center border-b border-deer-200 dark:border-deer-800">
                <img src="./AI.png" alt="AI" class="w-10 h-10 rounded-full object-cover mr-3 bg-white p-1 shadow-sm">
                <div>
                    <h3 class="font-bold text-deer-800 dark:text-deer-100">AI å°éº‹é¹¿</h3>
                    <div class="flex items-center text-xs">
                        <span class="w-2 h-2 rounded-full mr-1 transition-colors duration-300" 
                              :class="aiStatus === 'online' ? 'bg-green-500 animate-pulse' : 'bg-gray-400'"></span> 
                        <span x-text="aiStatus === 'online' ? 'ç·šä¸Š' : 'å¿™ç¢Œä¸­...'"></span>
                    </div>
                </div>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4 space-y-4 bg-white/30 dark:bg-black/20" id="chatContainer">
                <template x-for="msg in chatHistory" :key="msg.id">
                    <div class="flex w-full msg-pop" :class="msg.isUser ? 'justify-end' : 'justify-start'">
                        <div class="max-w-[80%] rounded-2xl px-4 py-2 shadow-sm"
                             :class="msg.isUser ? 'bg-deer-500 text-white rounded-br-none' : 'bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-bl-none'">
                            <p x-text="msg.text" class="whitespace-pre-line"></p>
                            <span class="text-[10px] opacity-70 block text-right mt-1" x-text="msg.time"></span>
                        </div>
                    </div>
                </template>
                <div x-show="isTyping" class="flex justify-start msg-pop">
                    <div class="bg-white dark:bg-gray-700 rounded-2xl rounded-bl-none px-4 py-3 flex space-x-1">
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-100"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-200"></div>
                    </div>
                </div>
            </div>

            <div class="p-4 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
                <form @submit.prevent="sendMessage" class="flex gap-2">
                    <input type="text" x-model="chatInput" :disabled="aiStatus !== 'online'" 
                           placeholder="è¼¸å…¥å•é¡Œ..." 
                           class="flex-1 rounded-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:ring-deer-400 focus:border-deer-400 px-4 py-2 disabled:opacity-50">
                    <button type="submit" :disabled="aiStatus !== 'online'" class="bg-deer-500 hover:bg-deer-600 text-white rounded-full p-2 w-10 h-10 flex items-center justify-center transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
                        â¤
                    </button>
                </form>
            </div>
        </div>

        <div x-show="currentTab === 'quiz'" x-cloak class="max-w-2xl mx-auto">
            <div x-show="!quizStarted && !quizEnded" class="text-center py-10 glass rounded-3xl p-10 shadow-xl">
                <div class="text-8xl mb-6 animate-bounce">ğŸ“</div>
                <h2 class="text-3xl font-bold mb-4">éº‹é¹¿å¤§æœƒè€ƒ 2.0</h2>
                <p class="text-gray-600 dark:text-gray-300 mb-8">
                    å…¨å°çš„è©±ï¼Œå°‡é ’ç™¼<br>
                    <span class="text-yellow-500 font-bold text-xl">ã€Œé‡‘ç‰Œéº‹é¹¿å‹³ç« ã€</span>ï¼ğŸ¥‡
                </p>
                <button @click="startQuiz" class="px-8 py-4 bg-gradient-to-r from-deer-400 to-purple-500 text-white rounded-full font-bold text-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all">
                    æŒ‘æˆ°é–‹å§‹
                </button>
            </div>

            <div x-show="quizStarted && !quizEnded">
                <div class="flex justify-between items-center mb-6">
                    <span class="font-bold text-deer-500">Question <span x-text="currentQuizIndex + 1"></span>/5</span>
                    <span class="text-sm bg-gray-200 dark:bg-gray-700 px-3 py-1 rounded-full">åˆ†æ•¸: <span x-text="quizScore"></span></span>
                </div>
                
                <div class="glass rounded-2xl p-8 mb-6 border-2 border-deer-200 dark:border-gray-700 min-h-[150px] flex items-center justify-center">
                    <h3 class="text-2xl font-bold text-center leading-relaxed" x-text="currentQuestion?.q || 'è®€å–ä¸­...'"></h3>
                </div>

                <div class="grid grid-cols-1 gap-4">
                    <template x-for="(opt, idx) in currentOptions" :key="idx">
                        <button @click="checkAnswer(opt)" 
                                :disabled="hasAnswered"
                                :class="getOptionClass(opt)"
                                class="w-full p-4 rounded-xl text-left font-medium transition-all transform hover:translate-x-1 border-2 relative shadow-sm">
                            <span class="inline-block w-6 h-6 rounded-full border border-current text-center text-xs leading-5 mr-3" x-text="['A','B','C','D'][idx]"></span>
                            <span x-text="opt"></span>
                            <span x-show="hasAnswered && opt === currentQuestion.a" class="absolute right-4 text-green-600 font-bold">âœ…</span>
                            <span x-show="hasAnswered && opt !== currentQuestion.a && selectedOption === opt" class="absolute right-4 text-red-500 font-bold">âŒ</span>
                        </button>
                    </template>
                </div>
                <button x-show="hasAnswered" @click="nextQuestion" class="mt-6 w-full py-3 bg-gray-800 text-white rounded-xl font-bold shadow-lg">
                    <span x-text="currentQuizIndex < 4 ? 'ä¸‹ä¸€é¡Œ âœ' : 'çœ‹çµæœ ğŸ†'"></span>
                </button>
            </div>

            <div x-show="quizEnded" class="text-center py-10 glass rounded-3xl p-10 shadow-2xl relative overflow-hidden">
                <div x-show="quizScore === 5" class="mb-4 relative z-10">
                    <img src="./é‡‘ç‰Œ.png" alt="é‡‘ç‰Œ" class="w-48 h-48 mx-auto object-contain animate-bounce medal-glow">
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-yellow-400 opacity-20 blur-3xl rounded-full -z-10 animate-pulse"></div>
                    <div class="text-2xl font-bold text-yellow-600 mt-6">æ­å–œç²å¾—ã€Œé‡‘ç‰Œéº‹é¹¿å‹³ç« ã€</div>
                </div>

                <div x-show="quizScore < 5" class="text-6xl mb-4">
                    <span x-text="quizScore >= 3 ? 'ğŸ¥ˆ' : 'ğŸ¤¡'"></span>
                </div>
                
                <h2 class="text-4xl font-black text-gray-800 dark:text-white mb-2">
                    å¾—åˆ†ï¼š<span x-text="quizScore * 20"></span> åˆ†
                </h2>
                <div class="flex gap-4 justify-center mt-8">
                    <button @click="startQuiz" class="px-6 py-3 bg-gray-200 dark:bg-gray-700 rounded-full font-bold">å†æ¸¬ä¸€æ¬¡</button>
                    <button @click="shareResult" class="px-6 py-3 bg-deer-500 text-white rounded-full font-bold shadow-lg">åˆ†äº«æˆç¸¾</button>
                </div>
            </div>
        </div>

        <div x-show="showToast" x-transition class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-black/80 text-white px-6 py-3 rounded-full text-sm z-50 shadow-lg">
            <span x-text="toastMessage"></span>
        </div>

    </main>

    <footer class="text-center py-8 text-gray-400 text-sm">
        <p>Â© 2025 é¹¿ğŸ¦Œçš„ QA æª”æ¡ˆå®¤ | Made for éº‹é¹¿å€‘</p>
    </footer>

    <script>
        function deerApp() {
            return {
                allData: window.DEER_QA || [],
                search: '',
                currentTab: 'home',
                isDark: false,
                flippedCards: [],
                showToast: false,
                toastMessage: '',
                
                currentPage: 1,
                itemsPerPage: 30,

                aiStatus: 'offline', 
                aiStatusText: 'ä¼‘æ¯ä¸­',
                wakeUpCount: 0,
                
                initApp() {
                    if (!this.allData || this.allData.length === 0) console.error("Error: DB not found");
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) this.toggleDarkMode();
                },

                get filteredQuestions() {
                    if (!this.allData) return [];
                    if (this.search.trim() === '') return this.allData;
                    
                    const searchChars = this.search.toLowerCase().split('').filter(c => c.trim() !== '');
                    return this.allData.map(item => {
                        let score = 0;
                        const fullText = (item.q + item.a).toLowerCase();
                        searchChars.forEach(char => { if (fullText.includes(char)) score += 10; });
                        if (item.q.toLowerCase().includes(this.search.toLowerCase())) score += 50; 
                        if (this.search === 'é¹¿å¥½ç¾' && item.id === 1) score += 999; 
                        return { ...item, score };
                    }).filter(item => item.score > 0).sort((a, b) => b.score - a.score);
                },

                get totalPages() { return Math.ceil(this.filteredQuestions.length / this.itemsPerPage); },
                get paginatedData() {
                    const start = (this.currentPage - 1) * this.itemsPerPage;
                    return this.filteredQuestions.slice(start, start + this.itemsPerPage);
                },
                nextPage() { if (this.currentPage < this.totalPages) { this.currentPage++; window.scrollTo({top: 0, behavior: 'smooth'}); } },
                prevPage() { if (this.currentPage > 1) { this.currentPage--; window.scrollTo({top: 0, behavior: 'smooth'}); } },
                goToPage(page) { this.currentPage = page; window.scrollTo({top: 0, behavior: 'smooth'}); },

                changeTab(tab) {
                    this.currentTab = tab;
                    window.scrollTo({top: 0, behavior: 'smooth'});
                    
                    if(tab === 'ai') {
                        this.wakeUpCount = 0;
                        if (Math.random() > 0.3) { 
                            this.aiStatus = 'offline';
                            // é€™è£¡æ–°å¢äº†ç›´æ’­ã€ç¡è¦ºç­‰ç‹€æ…‹
                            const statuses = [
                                'å‘¼å‘¼å¤§ç¡ä¸­... ğŸ˜´',
                                'æ­£åœ¨ç›´æ’­ï¼å¿«ä¾†çœ‹ ğŸ¥',
                                'æ­£åœ¨æ‰“å‚³èªª (ç’€ç’¨å ´å‹¿æ“¾) ğŸ®',
                                'å»åƒä¸‰è‰²è±†èŠ±å¸ƒä¸äº† ğŸ®',
                                'è¢«å“ºåš•è¸©åœ¨éµç›¤ä¸Š ğŸˆ',
                                'æ­£åœ¨ç·´ BLACKPINK çš„èˆ ğŸ’ƒ'
                            ];
                            this.aiStatusText = statuses[Math.floor(Math.random() * statuses.length)];
                        } else {
                            this.aiStatus = 'online';
                        }
                    }
                },

                wakeUpAI() {
                    if (this.aiStatus === 'online') return;
                    this.wakeUpCount++;
                    if (this.wakeUpCount >= 5) {
                        this.aiStatus = 'online';
                        this.addBotMessage("å¥½å•¦å¥½å•¦ï¼è¢«ä½ åµé†’äº†ï¼ ğŸ˜‰èªªå§æƒ³å•æˆ‘ä»€éº¼å•é¡Œï¼Ÿ");
                        this.wakeUpCount = 0;
                        confetti({ particleCount: 30, spread: 50, origin: { y: 0.5 } });
                    }
                },

                eggCount: 0,
                triggerEasterEgg(type) {
                    if (type === 'icon') this.showNotification("é€™æ˜¯ç§˜å¯†é€šé“å—ï¼Ÿ");
                    if (type === 'profile') {
                        this.eggCount++;
                        if (this.eggCount === 5) {
                            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                            this.showNotification("ğŸ‰ æ­å–œç™¼ç¾éš±è—å½©è›‹ï¼šç˜‹ç‹‚é»æ“Šï¼");
                            this.eggCount = 0;
                        }
                    }
                },

                chatInput: '',
                chatHistory: [],
                isTyping: false,
                sendMessage() {
                    if (!this.chatInput.trim()) return;
                    const userText = this.chatInput;
                    this.chatHistory.push({ id: Date.now(), text: userText, isUser: true, time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) });
                    this.chatInput = '';
                    this.$nextTick(() => { document.getElementById('chatContainer').scrollTop = 99999; });

                    this.isTyping = true;
                    setTimeout(() => {
                        this.isTyping = false;
                        const reply = this.getSmartAIResponse(userText);
                        this.addBotMessage(reply);
                    }, 800 + Math.random() * 500);
                },
                getSmartAIResponse(input) {
                    if (!this.allData) return "è³‡æ–™åº«è®€å–å¤±æ•— ğŸ˜µ";
                    const text = input.toLowerCase();
                    let keywords = text.split('');
                    if (text.includes("å¹¾æ­²")) keywords.push("å¹´é½¡", "ç”Ÿæ—¥");
                    if (text.includes("å“ªè£¡äºº")) keywords.push("ä½", "å®¶é„‰");
                    if (text.includes("æ„›")) keywords.push("å–œæ­¡", "ç”·å‹");

                    const candidates = this.allData.map(item => {
                        let score = 0;
                        const qText = item.q.toLowerCase();
                        keywords.forEach(k => { if(qText.includes(k)) score += 10; });
                        if (qText.includes(text)) score += 50;
                        return { ...item, score };
                    }).sort((a, b) => b.score - a.score);

                    const bestMatch = candidates[0];

                    if (text.includes("ä½ å¥½") || text.includes("å—¨")) return "ä½ å¥½å‘€ï¼æˆ‘æ˜¯æœ€è°æ˜çš„ AI å°éº‹é¹¿ï¼Œæœ‰å•é¡Œéƒ½å¯ä»¥å•æˆ‘ï¼";
                    if (text.includes("ç¬¨")) return "æˆ‘æ‰ä¸ç¬¨ï¼æˆ‘å¯æ˜¯è¨˜å¾— 100 å¤šæ¢é¹¿çš„è³‡æ–™å‘¢ğŸ˜¤";
                    if (text.includes("å½©è›‹")) return "å½©è›‹è—åœ¨... é ­åƒè£¡ï¼Ÿè©¦è‘—é»é»çœ‹ï¼ŸğŸ¤«";

                    if (!bestMatch || bestMatch.score < 5) {
                        const fallbacks = ["é€™å€‹å•é¡Œ... æª”æ¡ˆå®¤è£¡å¥½åƒæ²’æœ‰ç´€éŒ„è€¶ ğŸ¤”", "å—¯... é¹¿æœ¬äººå¯èƒ½æ‰çŸ¥é“å–”ï¼", "é€™é¡Œè¶…ç¶±äº†ï¼ä½ è¦ä¸è¦å»ç›´æ’­å•å•ï¼Ÿ"];
                        return fallbacks[Math.floor(Math.random() * fallbacks.length)];
                    }
                    return `é—œæ–¼ã€Œ${bestMatch.q}ã€...\n${bestMatch.a}`;
                },
                addBotMessage(text) {
                    this.chatHistory.push({ id: Date.now(), text: text, isUser: false, time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) });
                    this.$nextTick(() => { document.getElementById('chatContainer').scrollTop = 99999; });
                },

                tabClass(tab) {
                    const active = "bg-white dark:bg-gray-600 text-deer-600 dark:text-deer-300 shadow-sm";
                    const inactive = "text-gray-500 hover:text-gray-700 dark:hover:text-gray-300";
                    return `px-4 py-1.5 rounded-full text-sm font-medium transition-all ${this.currentTab === tab ? active : inactive}`;
                },
                toggleDarkMode() { this.isDark = !this.isDark; document.documentElement.classList.toggle('dark', this.isDark); },
                toggleCard(id) {
                    if (this.flippedCards.includes(id)) this.flippedCards = this.flippedCards.filter(cid => cid !== id);
                    else this.flippedCards.push(id);
                },
                showNotification(msg) { this.toastMessage = msg; this.showToast = true; setTimeout(() => this.showToast = false, 3000); },
                shareItem(item) {
                    const text = `ğŸ¦Œ é¹¿çš„å°ç§˜å¯† Q.${item.id}\nå•ï¼š${item.q}\nç­”ï¼š${item.a}\nâœ¨ ä¾†è‡ªï¼šé¹¿çš„ QA æª”æ¡ˆå®¤`;
                    navigator.clipboard.writeText(text).then(() => this.showNotification("âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼"));
                },

                quizStarted: false, quizEnded: false, quizData: [], currentQuizIndex: 0, 
                currentOptions: [], hasAnswered: false, selectedOption: null, quizScore: 0,

                startQuizMode() { this.changeTab('quiz'); this.quizStarted = false; this.quizEnded = false; },
                startQuiz() {
                    if (!this.allData || this.allData.length < 5) { alert("è³‡æ–™ä¸è¶³"); return; }
                    const shuffled = [...this.allData].sort(() => 0.5 - Math.random());
                    this.quizData = shuffled.slice(0, 5);
                    this.currentQuizIndex = 0; this.quizScore = 0;
                    this.quizStarted = true; this.quizEnded = false;
                    this.prepareQuestion();
                },
                get currentQuestion() { return this.quizData[this.currentQuizIndex] || { q: '', a: '' }; },
                prepareQuestion() {
                    this.hasAnswered = false; this.selectedOption = null;
                    const correctParams = this.currentQuestion.a;
                    const wrongPool = this.allData.filter(i => i.id !== this.currentQuestion.id).map(i => i.a);
                    const wrongOptions = wrongPool.sort(() => 0.5 - Math.random()).slice(0, 3);
                    this.currentOptions = [correctParams, ...wrongOptions].sort(() => 0.5 - Math.random());
                },
                checkAnswer(option) {
                    if (this.hasAnswered) return;
                    this.hasAnswered = true;
                    this.selectedOption = option;
                    if (option === this.currentQuestion.a) {
                        this.quizScore++;
                        confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 }, colors: ['#ec4899', '#db2777'] });
                    }
                },
                getOptionClass(option) {
                    if (!this.hasAnswered) return "bg-white dark:bg-gray-800 hover:bg-deer-50 border-transparent";
                    if (option === this.currentQuestion.a) return "bg-green-100 border-green-500 text-green-800"; 
                    if (option === this.selectedOption) return "bg-red-100 border-red-500 text-red-800"; 
                    return "bg-gray-100 opacity-50 border-transparent"; 
                },
                nextQuestion() {
                    if (this.currentQuizIndex < 4) { this.currentQuizIndex++; this.prepareQuestion(); }
                    else { 
                        this.quizEnded = true; 
                        if(this.quizScore === 5) this.triggerGoldMedalEffect();
                    }
                },
                triggerGoldMedalEffect() {
                    var duration = 3 * 1000;
                    var animationEnd = Date.now() + duration;
                    var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
                    var random = function(min, max) { return Math.random() * (max - min) + min; };
                    var interval = setInterval(function() {
                        var timeLeft = animationEnd - Date.now();
                        if (timeLeft <= 0) { return clearInterval(interval); }
                        var particleCount = 50 * (timeLeft / duration);
                        confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
                        confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
                    }, 250);
                },
                shareResult() {
                    const text = `æˆ‘åœ¨ã€Œé¹¿ğŸ¦Œçš„ QA æª”æ¡ˆå®¤ã€æ¸¬é©—æ‹¿äº† ${this.quizScore * 20} åˆ†ï¼\n${this.quizScore === 5 ? 'ğŸ† ç²å¾—é‡‘ç‰Œéº‹é¹¿å‹³ç« ï¼' : 'å¿«ä¾†æŒ‘æˆ°çœ‹çœ‹ï¼'}`;
                    navigator.clipboard.writeText(text).then(() => this.showNotification("âœ… å·²è¤‡è£½æˆç¸¾ï¼"));
                }
            }
        }
    </script>
</body>
</html>